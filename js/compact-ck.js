// function to fix the widths of the excerpts
function showLazyImages(e){var t=e.find($("img"));t.attr("src",t.attr("data-original"));$("img.lazy").removeClass("lazy")}var workInProgress="no",selection={position:0,moveUp:function(){selection.position>0&&(selection.position=selection.position-1)},moveDown:function(){selection.position=parseInt(selection.position,10)+1},show:function(){$(".compact.selected").removeClass("selected");$(".compact[data-post-number="+selection.position+"]").addClass("selected")}},handleClicks=function(e){console.log(e);var t=e.attr("data-post-number");selection.position=t;selection.show();if(e.hasClass("open"))e.removeClass("open");else{$(".compact.open").removeClass("open");e.addClass("open");showLazyImages(e);$("#view-area").scrollTop(41*t)}},fixExcerptWidths=function(){$.each($(".compact"),function(){var e=$(this).width(),t=$(this).find($(".blog_name")).outerWidth(),n=$(this).find($(".post_title")).outerWidth(),r=$(this).find($(".post_time")).outerWidth(),i=e-t-n-r-20,s=$(this).find($(".excerpt-preview"));if($(".compact").outerWidth()>480)if(i<10){s.css("display","none");$(this).find($(".post_title")).css("width",e-t-r-20)}else{s.css("display","block");s.outerWidth(i)}$(this).css("opacity","1")})},do_scroll_math=function(){var e=$("#posts").height(),t=Math.abs($("#posts").position().top),n=e-t;console.log(n);if(n<=1500&&workInProgress==="no"){workInProgress="yes";$(".endloader").css("bottom",0);$(".endloader").fadeTo("slow",1);var r="contr_get_extra_posts.php";$.post(r,function(e){$("#posts").append(e);fixExcerptWidths();$(".compact").fadeTo("slow",1);$(".compact").on("click",function(){handleClicks($(this))});$(document).scrollTop=n});$(".compact").css("opacity","1");workInProgress="no";handleClicks()}};$(document).ready(function(){selection.show();$(".compact").on("click",function(){handleClicks($(this))})});$(document).on("keydown",function(e){var t=e.which;console.log("key pressed: "+t);if(t===74||t===40){selection.moveDown();selection.show()}else if(t===75||t===38){selection.moveUp();selection.show()}else(t===13||t===32||t===79)&&handleClicks($(".compact.selected"))});$(window).load(function(){$(".loader").hide();fixExcerptWidths()});var do_resize_compact;$(window).resize(function(){clearTimeout(do_resize_compact);do_resize_compact=setTimeout(function(){$(".compact").css("opacity","0");fixExcerptWidths()},100)});var do_scroll_it;$("#view-area").scroll(function(){clearTimeout(do_scroll_it);do_scroll_it=setTimeout(function(){do_scroll_math()},100)});