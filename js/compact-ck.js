// function to fix the widths of the excerpts
function showLazyImages(e){var t=e.find($("img"));t.attr("src",t.attr("data-original"))}var workInProgress="no",selection={position:0,moveUp:function(){selection.position>0&&(selection.position=selection.position-1)},moveDown:function(){selection.position=parseInt(selection.position,10)+1},show:function(){$(".compact.selected").removeClass("selected");$(".compact[data-post-number="+selection.position+"]").addClass("selected")},focus:function(e){$(".compact.selected").removeClass("selected");selection.position=e.attr("data-post-number");$(".compact[data-post-number="+selection.position+"]").addClass("selected")}},images={show:function(){}},handleClicks=function(e){console.log(e);var t=e.attr("data-post-number");selection.position=t;selection.show();if(e.hasClass("open"))e.removeClass("open");else{$(".compact.open").removeClass("open");e.addClass("open");showLazyImages(e);$("#view-area").scrollTop(41*t)}},fixExcerptWidths=function(){$.each($(".compact"),function(){var e=$(this).width(),t=$(this).find($(".blog_name")).outerWidth(),n=$(this).find($(".post_title")).outerWidth(),r=$(this).find($(".post_time")).outerWidth(),i=e-t-n-r-20,s=$(this).find($(".excerpt-preview"));if($(".compact").outerWidth()>480)if(i<10){s.css("display","none");$(this).find($(".post_title")).css("width",e-t-r-20)}else{s.css("display","block");s.outerWidth(i)}$(this).css("opacity","1")})},posts={reset:function(){this.number=$(".compact").length;this.postheight=$(".compact").eq(0).outerHeight();this.perView=Math.floor($("#view-area").height()/this.postheight);this.amountScrolled=Math.floor(Math.abs($("#view-area").scrollTop())/this.postheight);this.firstPost=0},scrollDown:function(e){this.reset();var t=this.amountScrolled*this.postheight+this.postheight*e;$("#view-area").scrollTop(t)},scrollUp:function(e){this.reset();var t=this.amountScrolled*this.postheight-this.postheight*e;t>0?$("#view-area").scrollTop(t):$("#view-area").scrollTop(0)},show:function(){},hide:function(){},flow:function(){fixExcerptWidths()}},do_scroll_math=function(){var e=$("#posts").height(),t=$("#view-area").scrollTop(),n=e-t;console.log(n);if(n<=1500&&workInProgress==="no"){workInProgress="yes";$(".endloader").css("bottom",0);$(".endloader").fadeTo("slow",1);var r="contr_get_extra_posts.php";$.post(r,function(e){$("#posts").append(e);posts.flow();$(".compact").fadeTo("slow",1);$(".compact").on("click",function(){handleClicks($(this))});$(document).scrollTop=n});$(".compact").css("opacity","1");workInProgress="no";handleClicks()}};$(document).ready(function(){selection.show();$(".compact").on("click",function(){selection.focus($(this));handleClicks($(this))})});$(document).on("keydown",function(e){var t=e.which;console.log("key pressed: "+t);if(t===74||t===40){selection.moveDown();selection.show()}else if(t===75||t===38){selection.moveUp();selection.show()}else(t===13||t===32||t===79)&&handleClicks($(".compact.selected"))});var do_resize_compact;$(window).resize(function(){clearTimeout(do_resize_compact);do_resize_compact=setTimeout(function(){posts.flow();posts.show()},100)});var do_scroll_it;$("#view-area").scroll(function(){clearTimeout(do_scroll_it);do_scroll_it=setTimeout(function(){do_scroll_math()},100)});var closeMenus=function(){$("#show-about li").removeClass("selected");$("#show-search li").removeClass("selected");$("#show-login li").removeClass("selected");$("#left-col-wrapper.float_it").css("display","none");$("#left-col-wrapper").removeClass("float_it");$("#menu-about").hide();$("#menu-search").hide();$("#menu-login").hide()};$("#show-about li").click(function(){if($("#show-about li").hasClass("selected"))closeMenus();else{closeMenus();$("#show-about li").toggleClass("selected");$("#menu-about").toggle()}});$("#show-search li").click(function(){if($("#show-search li").hasClass("selected"))closeMenus();else{closeMenus();$("#show-search li").toggleClass("selected");$("#menu-search").toggle()}});var leftNav={toggle:function(){$("#left-col-wrapper").toggle();$("#hamburger").toggle()},hide:function(){$("#left-col-wrapper").css("display","none");$("#hamburger").css("display","block")},show:function(){$("#left-col-wrapper").css("display","block");$("#hamburger").css("display","none")},visible:function(){return $("#left-col-wrapper").css("display")==="block"?!0:!1},init:function(){$(window).width()>768?leftNav.show():leftNav.hide()}};$("#hamburger").on("click",function(){leftNav.show();posts.flow()});$(".leftNav-dismiss").on("click",function(){leftNav.hide();posts.flow()});var modal={hide:function(){$("#modal").css("display","none")},show:function(){$("#modal").css("display","block")},message:function(e){$("#modal-body").html("<p>"+e+"<p>");modal.show()}},viewArea={getDetails:function(){var e=$(window).outerWidth(),t=$("#left-col-wrapper").outerWidth(),n=$("#left-col-wrapper").css("display");this.width=n==="block"?e-t:e;this.height=$(window).outerHeight()-$(".mainbar-wrapper").outerHeight()}},windows={setSizes:function(){viewArea.getDetails();$("#view-area").css("height",viewArea.height);$("#left-col-wrapper").css("height",$(window).height())}};$(window).load(function(){windows.setSizes();leftNav.init();$("#view-area").css("-webkit-overflow-scrolling","touch");$(".loader").fadeTo("fast",0,function(){posts.flow();images.show();posts.show()})});$(window).resize(function(){windows.setSizes()});